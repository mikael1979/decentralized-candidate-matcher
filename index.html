<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Decentralized Candidate Matcher</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div id="app">
        <!-- Area Selection View - N√ÑKYVISS√Ñ ALUksi -->
        <div id="area-selection-view" class="view active">
            <div class="area-selection-header">
                <h1 data-i18n="app.title">üó≥Ô∏è Election Matcher</h1>
                <p data-i18n="app.description">Select your location and election type to get started</p>
            </div>
            
            <!-- Language Selector -->
            <div class="language-selector">
                <label data-i18n="navigation.language">Language:</label>
                <select id="language-select" onchange="changeLanguage(this.value)">
                    <option value="en">English</option>
                    <option value="fi">Suomi</option>
                    <option value="sv">Svenska</option>
                </select>
            </div>
            
            <div class="area-selection-container">
                <div class="selection-steps">
                    <!-- Step 1: Continent -->
                    <div class="selection-step active" data-step="1">
                        <div class="step-header">
                            <span class="step-number">1</span>
                            <h3 data-i18n="navigation.selectContinent">Select Continent</h3>
                        </div>
                        <div class="options-grid" id="continent-options">
                            <!-- Generated by JavaScript -->
                        </div>
                    </div>

                    <!-- Step 2: Country -->
                    <div class="selection-step" data-step="2">
                        <div class="step-header">
                            <span class="step-number">2</span>
                            <h3 data-i18n="navigation.selectCountry">Select Country</h3>
                        </div>
                        <div class="options-grid" id="country-options">
                            <p class="step-info">Please select a continent first</p>
                        </div>
                    </div>

                    <!-- Step 3: Municipality -->
                    <div class="selection-step" data-step="3">
                        <div class="step-header">
                            <span class="step-number">3</span>
                            <h3 data-i18n="navigation.selectMunicipality">Select Municipality</h3>
                        </div>
                        <div class="options-grid" id="municipality-options">
                            <p class="step-info">Please select a country first</p>
                        </div>
                    </div>

                    <!-- Step 4: Election Type -->
                    <div class="selection-step" data-step="4">
                        <div class="step-header">
                            <span class="step-number">4</span>
                            <h3 data-i18n="navigation.selectElection">Select Election Type</h3>
                        </div>
                        <div class="options-grid" id="election-options">
                            <p class="step-info">Please select a municipality first</p>
                        </div>
                    </div>
                </div>

                <div class="selection-actions">
                    <button id="prev-step" class="btn-secondary" disabled data-i18n="button.previous">Previous</button>
                    <button id="next-step" class="btn-primary" disabled data-i18n="button.next">Next</button>
                    <button id="start-app" class="btn-success" disabled data-i18n="navigation.startApp">Start Application</button>
                </div>

                <div class="selected-summary" id="selected-summary">
                    <h4 data-i18n="navigation.yourSelection">Your Selection:</h4>
                    <div id="selection-details"></div>
                </div>
            </div>
        </div>

        <!-- Olemassa olevat n√§kym√§t PIILOSSA aluksi -->
        <header class="hidden">
            <h1>üó≥Ô∏è Decentralized Candidate Matcher</h1>
            <nav>
                <button onclick="showView('compare')" data-i18n="navigation.compare">Compare Questions</button>
                <button onclick="showView('submit')" data-i18n="navigation.submit">Create New Question</button>
                <button onclick="showView('browse')" data-i18n="navigation.browse">Browse Questions</button>
                <button onclick="startCandidateComparison()" data-i18n="navigation.candidates">Match with Candidates</button>
                <button onclick="showView('stats')" data-i18n="navigation.stats">Statistics</button>
                <button onclick="exportData()" data-i18n="navigation.export">Export JSON</button>
                <button onclick="importData()" data-i18n="navigation.import">Import JSON</button>
                <button onclick="changeArea()" data-i18n="navigation.changeArea">Change Area</button>
            </nav>
        </header>

        <main class="hidden">
            <!-- Comparison View -->
            <div id="compare-view" class="view">
                <h2 data-i18n="navigation.compare">Compare Questions</h2>
                <div id="comparison-container" class="comparison-container">
                    <div class="question-card" id="question-a">
                        <h3>Question A</h3>
                        <p id="question-a-text"></p>
                        <button onclick="vote('a')">Choose this</button>
                    </div>
                    
                    <div class="vs">VS</div>
                    
                    <div class="question-card" id="question-b">
                        <h3>Question B</h3>
                        <p id="question-b-text"></p>
                        <button onclick="vote('b')">Choose this</button>
                    </div>
                </div>
                <div class="progress">
                    <span id="progress-text">0/10 comparisons done</span>
                    <progress id="progress-bar" value="0" max="10"></progress>
                </div>
            </div>

            <!-- Question Creation View -->
            <div id="submit-view" class="view">
                <h2 data-i18n="navigation.submit">Create New Question</h2>
                <form id="question-form">
                    <textarea 
                        id="question-input" 
                        placeholder="Write your question here..." 
                        data-i18n-placeholder="question.writePlaceholder"
                        required
                    ></textarea>
                    
                    <div class="tag-section">
                        <h4 data-i18n="question.addTags">Add Tags:</h4>
                        <div id="tag-suggestions" class="tag-suggestions"></div>
                        <input 
                            type="text" 
                            id="tag-input" 
                            placeholder="Add new tag..."
                            data-i18n-placeholder="question.addNewTag"
                        >
                        <button type="button" onclick="addCustomTag()" data-i18n="question.addTagButton">Add Tag</button>
                    </div>

                    <div id="duplicate-warning" class="warning hidden">
                        <h4>‚ö†Ô∏è Similar question found:</h4>
                        <div id="duplicate-list"></div>
                    </div>

                    <button type="submit" data-i18n="question.createButton">Create Question</button>
                </form>
            </div>

            <!-- Browse View -->
            <div id="browse-view" class="view">
                <h2 data-i18n="navigation.browse">Browse Questions</h2>
                <input 
                    type="text" 
                    id="search-input" 
                    placeholder="Search questions..."
                    data-i18n-placeholder="browse.searchPlaceholder"
                    oninput="searchQuestions(this.value)"
                >
                <div id="questions-list" class="questions-list"></div>
            </div>

            <!-- Statistics View -->
            <div id="stats-view" class="view">
                <h2 data-i18n="navigation.stats">Statistics</h2>
                <div class="stats-grid">
                    <div class="stat-card">
                        <h3 data-i18n="stats.questions">Questions</h3>
                        <span id="total-questions">0</span>
                    </div>
                    <div class="stat-card">
                        <h3 data-i18n="stats.tags">Tags</h3>
                        <span id="total-tags">0</span>
                    </div>
                    <div class="stat-card">
                        <h3 data-i18n="stats.comparisons">Comparisons</h3>
                        <span id="total-comparisons">0</span>
                    </div>
                    <div class="stat-card">
                        <h3 data-i18n="stats.users">Users</h3>
                        <span id="total-users">1</span>
                    </div>
                    <div class="stat-card">
                        <h3 data-i18n="stats.candidates">Candidates</h3>
                        <span id="total-candidates">0</span>
                    </div>
                    <div class="stat-card">
                        <h3>Your Comparisons</h3>
                        <span id="user-comparisons">0</span>
                    </div>
                </div>
                
                <div class="stats-sections">
                    <div class="stats-section">
                        <h3 data-i18n="stats.popularTags">Popular Tags</h3>
                        <div id="popular-tags" class="tags-container"></div>
                    </div>
                    
                    <div class="stats-section">
                        <h3 data-i18n="stats.topQuestions">Top Questions</h3>
                        <div id="top-questions" class="questions-list"></div>
                    </div>
                    
                    <div class="stats-section">
                        <h3>Candidate Statistics</h3>
                        <div id="candidate-stats"></div>
                    </div>
                    
                    <div class="stats-section">
                        <h3>System Information</h3>
                        <div id="system-info"></div>
                    </div>
                </div>
            </div>

            <!-- Candidate Questions View -->
            <div id="candidate-questions-view" class="view">
                <h2 data-i18n="candidate.answerQuestions">Answer Questions</h2>
                <div id="candidate-question-container"></div>
            </div>

            <!-- Compatibility Results View -->
            <div id="compatibility-results-view" class="view">
                <h2 data-i18n="candidate.compatibilityResults">Compatibility Results</h2>
                <div id="compatibility-results-container"></div>
            </div>

            <!-- Candidate Details View -->
            <div id="candidate-details-view" class="view">
                <div class="candidate-details-header">
                    <button onclick="showView('compatibility-results')" class="back-button" data-i18n="button.back">‚Üê Back to Results</button>
                    <h2 data-i18n="candidate.details">Candidate Details</h2>
                </div>
                <div id="candidate-details-container" class="candidate-details-container"></div>
            </div>
        </main>
    </div>

    <!-- Load BaseManager FIRST -->
    <script src="js/core/BaseManager.js"></script>
    
    <!-- Load config and core modules -->
    <script src="js/core/dynamic-config-manager.js"></script>
    <script src="js/core/locale-manager.js"></script>
    <script src="js/core/dynamic-area-manager.js"></script>
    
    <!-- Load area selection module -->
    <script src="js/modules/area-selection.js"></script>
    
    <!-- Load UPDATED BaseManager-based modules -->
    <script src="js/question-manager.js"></script>
    <script src="js/tag-system.js"></script>
    <script src="js/duplicate-detector.js"></script>
    <script src="js/rating-system.js"></script>
    <script src="js/candidate-manager.js"></script>
    <script src="js/compatibility-calculator.js"></script>
    
    <!-- Load other modules -->
    <script src="js/ViewManager.js"></script>
    <script src="js/ComparisonManager.js"></script>
    <script src="js/CandidateQuestionsManager.js"></script>
    <script src="js/StatsManager.js"></script>
    
    <!-- Load main app LAST -->
    <script src="js/app.js"></script>
</body>
</html>
